{% extends "base.html" %}
{% load i18n thumbnail staticfiles pifti %}
{% block page_class %}Gallery{% endblock %}
{% load cache %}

{% block content %}
<h1>i'm from the internet.</h1>
  {% if pagination_list %}
  <div id="gallery" class="clearfix">
  {% for post in pagination_list %}
    {% if post.image %}
    <div class="gallery_item">
      <a target="_blank" href="{{ post.image.url }}"><img src="{{ post.image.avatar.url }}" /></a>
      {% cache 86400 post_imagetype post.id %}
      {% if post.image|isanimated %}
      <div class="imagetype">
          <span>{% imagetype post.image %}</span>
      </div>
      {% endif %}
      {% endcache %}
    </div>
    {% endif %}
    {% for comment in post.comment_set.all %}
      {% if comment.image %}
      <div class="gallery_item">
        <a target="_blank" href="{{ comment.image.url }}"><img src="{{ comment.image.avatar.url }}" /></a>
        {% cache 86400 comment_imagetype comment.id %}
        {% if comment.image|isanimated %}
        <div class="imagetype">
            <span>{% imagetype comment.image %}</span>
        </div>
        {% endif %}
        {% endcache %}
      </div>
      {% endif %}
    {% endfor %}
  {% endfor %}
  </div>
  <a class="mobile-top" href="#top">Back to Top</a>
  {% else %}
  <p>No images are available.</p>
  {% endif %}
{% endblock %}